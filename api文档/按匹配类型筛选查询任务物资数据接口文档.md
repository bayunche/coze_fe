# 按匹配类型筛选查询任务物资数据接口文档

## 接口说明

支持按人工修改物资、系统自动匹配的物资、查全部三种类型筛选查询任务物资数据。

## 接口地址

```
POST /api/materials/partyb/query-by-type
```

## 请求参数

### 请求体 (JSON)

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| taskId | String | 是 | 任务ID |
| page | Integer | 否 | 页码（从0开始），默认0 |
| size | Integer | 否 | 每页大小，默认10 |
| keyword | String | 否 | 搜索关键词 |
| confirmResult | Integer | 否 | 确认结果筛选（0：未确认，1：已确认，不传则查询全部） |
| matchedType | Integer | 否 | 匹配类型筛选（0：无匹配，1：精确匹配，2：相似匹配，3：历史匹配，4：人工匹配，不传则查询全部） |
| queryType | Integer | 否 | 查询类型（1：人工修改物资，2：系统自动匹配的物资，3：查全部） |

### queryType参数说明

| queryType值 | 查询条件 | 说明 |
|------------|----------|------|
| 1 | confirmResult = 1 AND confirmType IN (2, 3) | 人工修改过的物资数据 |
| 2 | confirmType IN (1, 4) OR (comparisonResult IN (1, 3) AND NOT (confirmResult = 1 AND confirmType IN (2, 3))) | 系统自动匹配的物资数据 |
| 3 | 无额外条件 | 查询所有数据 |

### 特殊规则说明

对于同时满足以下条件的数据：
- comparisonResult IN (1, 3) 
- confirmResult = 1 且 confirmType IN (2, 3)

这类数据将被归类为**人工修改物资**，在查询时：
- 使用 queryType = 1 会包含这些数据
- 使用 queryType = 2 不会包含这些数据

## 响应参数

### 响应体 (JSON)

| 参数名 | 类型 | 说明 |
|--------|------|------|
| content | Array | 物资数据列表 |
| pageInfo | Object | 分页信息 |

### content数组元素结构

| 参数名 | 类型 | 说明 |
|--------|------|------|
| taskDataId | String | 任务数据ID |
| taskId | String | 任务ID |
| taskDetailId | String | 任务详情ID |
| materialName | String | 物资名称 |
| specifications | String | 规格型号 |
| unit | String | 单位 |
| quantity | String | 数量 |
| unitPrice | String | 单价 |
| taxPrice | String | 含税价 |
| totalPrice | String | 总价 |
| confirmResult | Integer | 确认结果（0：未确认，1：已确认） |
| confirmBaseDataId | String | 确认的基础数据ID |
| confirmPriceId | String | 确认的价格数据ID |
| confirmType | Integer | 确认类型 |
| matchedType | Integer | 匹配类型 |
| originalPrice | String | 原始价格 |
| taxExcludedPrice | String | 不含税价 |
| priceType | Integer | 价格类型 |
| baseInfo | Object | 基础信息 |
| priceInfo | Object | 价格信息 |
| matchOptions | Array | 匹配选项列表 |

### pageInfo结构

| 参数名 | 类型 | 说明 |
|--------|------|------|
| currentPage | Integer | 当前页码 |
| pageSize | Integer | 每页大小 |
| totalElements | Long | 总元素数 |
| totalPages | Integer | 总页数 |
| first | Boolean | 是否第一页 |
| last | Boolean | 是否最后一页 |
| hasNext | Boolean | 是否有下一页 |
| hasPrevious | Boolean | 是否有上一页 |

## 示例

### 请求示例

```json
{
  "taskId": "task-123456",
  "page": 0,
  "size": 10,
  "queryType": 1
}
```

### 响应示例

```json
{
  "content": [
    {
      "taskDataId": "data-001",
      "taskId": "task-123456",
      "materialName": "电缆",
      "specifications": "YJV-4*25+1*16",
      "unit": "米",
      "quantity": "100",
      "unitPrice": "12.50",
      "taxPrice": "12.50",
      "confirmResult": 1,
      "confirmBaseDataId": "base-001",
      "confirmPriceId": "price-001",
      "confirmType": 2,
      "matchedType": 3,
      "originalPrice": "12.50",
      "taxExcludedPrice": "11.06",
      "priceType": 1
    }
  ],
  "pageInfo": {
    "currentPage": 0,
    "pageSize": 10,
    "totalElements": 25,
    "totalPages": 3,
    "first": true,
    "last": false,
    "hasNext": true,
    "hasPrevious": false
  }
}
```

## 错误码

| 错误码 | 说明 |
|--------|------|
| 400 | 参数错误 |
| 500 | 服务器内部错误 |